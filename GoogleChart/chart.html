<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="script/script.js"></script>
  </head>
  <body>
    <h2>Sensor Data</h2>
    <button id="measureBtn" onclick="triggerMeasurement()">Take Measurement</button>
    <div id="status" style="margin: 10px 0; color: green;"></div>
    <div id="table_div" style="width: 900px; height: 500px"></div>
    
    <script>
      function triggerMeasurement() {
        const statusDiv = document.getElementById('status');
        statusDiv.textContent = 'Triggering measurement...';
        
        fetch('http://localhost:3000/api/trigger')
          .then(response => response.json())
          .then(data => {
            statusDiv.textContent = data.message + ' (Pico will measure on next check)';
            setTimeout(() => {
              statusDiv.textContent = '';
              fetchAndDrawTable(); // Refresh table after a moment
            }, 2000);
          })
          .catch(error => {
            statusDiv.textContent = 'Error: ' + error.message;
            statusDiv.style.color = 'red';
          });
      }
    </script>
  </body>
</html>